/*
 * colorWash.js 1.0.0
 * https://github.com/bobdepalmo/colorwash.js
 * @license MIT licensed
 *
 * Copyright (C) 2016 depalmo.com - A project by Bob DePalmo
 */
!function(){function a(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}this.colorWash=function(){var b={el:".colorwash",steps:2,speed:100,type:"vertical",opacity:1,file:"themes.json",theme:"nine",invert:!1};this.options=arguments[0]&&"object"==typeof arguments[0]?a(b,arguments[0]):b},colorWash.prototype.init=function(a){var b=this;Array.isArray(b.options.theme)?b.build(b.options.invert?b.options.theme.reverse():b.options.theme):this.loadJSON(b.options.file,function(a){var c=b.options.theme,d=JSON.parse(a);b.colors=b.options.invert?d[c].reverse():d[c],b.build(colors)})},colorWash.prototype.loadJSON=function(a,b){var c=new XMLHttpRequest;c.overrideMimeType("application/json"),c.open("GET",a,!0),c.onreadystatechange=function(){4==c.readyState&&"200"==c.status&&b(c.responseText)},c.send(null)},colorWash.prototype.gradient=function(){var a=this;switch(a.options.type){case"radial":return["-webkit-radial-gradient(","-moz-radial-gradient(","-o-radial-gradient(","radial-gradient("];case"horizontal":return["-webkit-linear-gradient(left,","-moz-linear-gradient(right,","-o-linear-gradient(right,","linear-gradient(right,"];case"vertical":return["-webkit-linear-gradient(","-moz-linear-gradient(","-o-linear-gradient(","linear-gradient("];case"diagonal":return["-webkit-linear-gradient(left top,","-moz-linear-gradient(bottom right,","-o-linear-gradient(bottom right,","linear-gradient(to bottom right,"]}},colorWash.prototype.build=function(a){var b=this;b.n=0,b.colorIndices=[0,1,2,3];var c=document.querySelector(b.options.el);c.style.opacity=b.options.opacity,b.gr=b.gradient(),b.gradientSpeed=b.options.steps/1e3,b.run(a,b.gr),b.timer=setInterval(function(){b.run(a,b.gr)},b.options.speed)},colorWash.prototype.run=function(a,b){var c=this;c.el=document.querySelector(c.options.el),c.a=a[c.colorIndices[0]],c.b=a[c.colorIndices[1]],c.c=a[c.colorIndices[2]],c.d=a[c.colorIndices[3]],c.e=1-this.n,f=Math.round(c.e*c.a[0]+c.n*c.b[0]),g=Math.round(c.e*c.a[1]+c.n*c.b[1]),h=Math.round(c.e*c.a[2]+c.n*c.b[2]),i="rgb("+f+","+g+","+h+")",j=Math.round(c.e*c.c[0]+c.n*c.d[0]),k=Math.round(c.e*c.c[1]+c.n*c.d[1]),l=Math.round(c.e*c.c[2]+c.n*c.d[2]),m="rgb("+j+","+k+","+l+")",c.el.style.backgroundImage=""+b[0]+i+", "+m+")",c.el.style.backgroundImage=""+b[1]+i+", "+m+")",c.el.style.backgroundImage=""+b[2]+i+", "+m+")",c.el.style.backgroundImage=""+b[3]+i+", "+m+")",c.n+=c.gradientSpeed,c.n>=1&&(c.n%=1,c.colorIndices[0]=c.colorIndices[1],c.colorIndices[2]=c.colorIndices[3],c.colorIndices[1]=(c.colorIndices[1]+Math.floor(1+Math.random()*(a.length-1)))%a.length,c.colorIndices[3]=(c.colorIndices[3]+Math.floor(1+Math.random()*(a.length-1)))%a.length)},colorWash.prototype.update=function(a){var b=this;this.loadJSON(b.options.file,function(c){var d=a,e=JSON.parse(c);colors=b.options.invert?e[d].reverse():e[d],b.gr=b.gradient(),b.run(colors,b.gr)})},colorWash.prototype.stop=function(){var a=this;clearInterval(a.timer)},colorWash.prototype.start=function(){var a=this;a.timer=setInterval(function(){a.run(a.colors,a.gr)},a.options.speed)},colorWash.prototype.destroy=function(){var a=this;clearInterval(a.timer),a.el=document.querySelector(a.options.el),a.el.parentNode.removeChild(a.el)}}();